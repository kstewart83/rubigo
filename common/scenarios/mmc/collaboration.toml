# ============================================================================
# Collaboration Module Requirements
# ============================================================================
# This file contains requirements for the Collaboration module including:
# - Calendar (Phase 1)
# - Email, Chat, Screen Share (Phase 2 - stubs)

[description]
overview = """
COLLABORATION MODULE
- Calendar: Event scheduling, recurrence, participants, views
- Email: Coming Soon
- Chat: Coming Soon  
- Screen Share: Coming Soon

This module provides unified collaboration tools for the organization.
"""

# ============================================================================
# SUB-OBJECTIVES (under obj-rubigo-events from projects.toml)
# ============================================================================

[[objectives]]
id = "obj-calendar-core"
title = "Calendar Event Management"
description = "Users must be able to create, view, edit, and delete calendar events with support for various event types and scheduling flexibility"
project_id = "d4e5f6"
parent_id = "obj-rubigo-events"
status = "planned"

[[objectives]]
id = "obj-calendar-recurrence"
title = "Recurring Event Support"
description = "Users must be able to schedule recurring events with various frequencies and manage individual instances without affecting the entire series"
project_id = "d4e5f6"
parent_id = "obj-rubigo-events"
status = "planned"

[[objectives]]
id = "obj-calendar-views"
title = "Calendar Visualization"
description = "Users must be able to view their schedule in multiple formats (month, week, day) to effectively plan and manage their time"
project_id = "d4e5f6"
parent_id = "obj-rubigo-events"
status = "planned"

[[objectives]]
id = "obj-collaboration-future"
title = "Future Collaboration Tools"
description = "The platform will provide integrated email, chat, and screen sharing capabilities to enable seamless team collaboration"
project_id = "d4e5f6"
parent_id = "obj-it-business-systems"
status = "planned"

# ============================================================================
# FEATURES - Calendar Core
# ============================================================================

[[features]]
id = "feat-calendar-crud"
name = "Calendar Event CRUD"
description = "Create, read, update, delete calendar events with full event details"
objective_id = "obj-calendar-core"
status = "planned"

[[features]]
id = "feat-calendar-recurrence"
name = "Recurring Event Management"
description = "Support for daily, weekly, monthly, yearly recurrence with instance deviations"
objective_id = "obj-calendar-recurrence"
status = "planned"

[[features]]
id = "feat-calendar-views"
name = "Calendar View Modes"
description = "Month view grid, week view, and day view with time slots"
objective_id = "obj-calendar-views"
status = "planned"

[[features]]
id = "feat-calendar-navigation"
name = "Calendar Navigation"
description = "Navigate between months/weeks, jump to today, work week toggle"
objective_id = "obj-calendar-views"
status = "planned"

[[features]]
id = "feat-calendar-participants"
name = "Event Participants"
description = "Assign organizers and participants to events"
objective_id = "obj-calendar-core"
status = "planned"

[[features]]
id = "feat-calendar-timezone"
name = "Event Timezone Management"
description = "Select event timezone and display local time conversion when event timezone differs from user's local timezone"
objective_id = "obj-calendar-core"
status = "planned"

[[features]]
id = "feat-calendar-day-view"
name = "Day View Mode"
description = "Single day view with hourly time slots for detailed daily schedule"
objective_id = "obj-calendar-views"
status = "planned"

[[features]]
id = "feat-calendar-all-day"
name = "All Day Events"
description = "Mark events as all-day to display without specific times"
objective_id = "obj-calendar-core"
status = "planned"

[[features]]
id = "feat-calendar-overlap"
name = "Overlapping Event Display"
description = "Display overlapping events side-by-side in day and week views with proper lane assignment"
objective_id = "obj-calendar-views"
status = "in_progress"

[[features]]
id = "feat-calendar-current-time"
name = "Current Time Indicator"
description = "Display a real-time indicator showing the current time in Day view, automatically updating without page refresh"
objective_id = "obj-calendar-views"
status = "in_progress"

# ============================================================================
# RULES - Calendar Event Management
# ============================================================================

# --- Event CRUD Rules ---

[[rules]]
id = "rule-calendar-list"
feature_id = "feat-calendar-crud"
role = "Platform User"
requirement = "view all calendar events in a visual calendar format"
reason = "understand my schedule and upcoming commitments"
status = "draft"

[[rules]]
id = "rule-calendar-create"
feature_id = "feat-calendar-crud"
role = "Platform User"
requirement = "create a new calendar event with title, date/time, and optional details"
reason = "schedule meetings and appointments"
status = "draft"

[[rules]]
id = "rule-calendar-view-detail"
feature_id = "feat-calendar-crud"
role = "Platform User"
requirement = "view full details of a calendar event"
reason = "see location, participants, and description"
status = "draft"

[[rules]]
id = "rule-calendar-edit"
feature_id = "feat-calendar-crud"
role = "Event Organizer"
requirement = "modify an existing calendar event"
reason = "update meeting details as plans change"
status = "draft"

[[rules]]
id = "rule-calendar-delete"
feature_id = "feat-calendar-crud"
role = "Event Organizer"
requirement = "delete a calendar event"
reason = "remove cancelled meetings from the schedule"
status = "draft"

# --- Recurrence Rules ---

[[rules]]
id = "rule-calendar-recurrence-create"
feature_id = "feat-calendar-recurrence"
role = "Platform User"
requirement = "create recurring events with daily, weekly, monthly, or yearly frequency"
reason = "schedule repetitive meetings without manual entry"
status = "draft"

[[rules]]
id = "rule-calendar-recurrence-days"
feature_id = "feat-calendar-recurrence"
role = "Platform User"
requirement = "specify which days of the week for weekly recurring events"
reason = "schedule meetings that occur on specific days like Mon/Wed/Fri"
status = "draft"

[[rules]]
id = "rule-calendar-instance-cancel"
feature_id = "feat-calendar-recurrence"
role = "Event Organizer"
requirement = "cancel a single instance of a recurring event"
reason = "skip one occurrence without deleting the entire series"
status = "draft"

[[rules]]
id = "rule-calendar-instance-modify"
feature_id = "feat-calendar-recurrence"
role = "Event Organizer"
requirement = "modify a single instance of a recurring event"
reason = "change the time or location for one occurrence"
status = "draft"

[[rules]]
id = "rule-calendar-recurrence-until"
feature_id = "feat-calendar-recurrence"
role = "Platform User"
requirement = "set an end date for recurring events"
reason = "limit recurring events to a specific time period"
status = "draft"

[[rules]]
id = "rule-calendar-instance-move"
feature_id = "feat-calendar-recurrence"
role = "Event Organizer"
requirement = "move a single instance of a recurring event to a different date"
reason = "reschedule one occurrence without affecting the rest of the series"
status = "draft"

[[rules]]
id = "rule-calendar-series-edit"
feature_id = "feat-calendar-recurrence"
role = "Event Organizer"
requirement = "edit all instances of a recurring event series at once"
reason = "update recurring event details without modifying each instance separately"
status = "draft"

[[rules]]
id = "rule-calendar-recurring-delete-choice"
feature_id = "feat-calendar-recurrence"
role = "Event Organizer"
requirement = "be presented with options to delete just this occurrence or all occurrences when deleting a recurring event"
reason = "avoid accidentally deleting an entire series when intending to skip one meeting"
status = "draft"

[[rules]]
id = "rule-calendar-recurring-edit-choice"
feature_id = "feat-calendar-recurrence"
role = "Event Organizer"
requirement = "be presented with options to edit just this occurrence or all occurrences when editing a recurring event"
reason = "clearly distinguish between modifying one instance vs changing the entire series"
status = "draft"

# --- View Rules ---

[[rules]]
id = "rule-calendar-month-view"
feature_id = "feat-calendar-views"
role = "Platform User"
requirement = "view the calendar in month grid format showing all events as pills"
reason = "see an overview of the entire month"
status = "draft"

[[rules]]
id = "rule-calendar-week-view"
feature_id = "feat-calendar-views"
role = "Platform User"
requirement = "view the calendar in week format with time slots"
reason = "see detailed daily schedule with time positioning"
status = "draft"

[[rules]]
id = "rule-calendar-workweek"
feature_id = "feat-calendar-views"
role = "Platform User"
requirement = "toggle between full week and work week (Mon-Fri) display"
reason = "focus on business days without weekend clutter"
status = "draft"

# --- Day View Rules ---

[[rules]]
id = "rule-calendar-day-view"
feature_id = "feat-calendar-day-view"
role = "Platform User"
requirement = "view the calendar in single day format with hourly time slots"
reason = "focus on one day's detailed schedule"
status = "draft"

[[rules]]
id = "rule-calendar-day-nav"
feature_id = "feat-calendar-day-view"
role = "Platform User"
requirement = "navigate forward and backward through individual days"
reason = "view past and future daily schedules"
status = "draft"

# --- All Day Event Rules ---

[[rules]]
id = "rule-calendar-all-day-toggle"
feature_id = "feat-calendar-all-day"
role = "Platform User"
requirement = "toggle an event as 'All Day' when creating or editing"
reason = "schedule events that span the entire day without specific times"
status = "draft"

[[rules]]
id = "rule-calendar-all-day-display"
feature_id = "feat-calendar-all-day"
role = "Platform User"
requirement = "see all-day events displayed without time information"
reason = "quickly identify full-day events vs timed events"
status = "draft"

[[rules]]
id = "rule-calendar-all-day-form"
feature_id = "feat-calendar-all-day"
role = "Platform User"
requirement = "have time fields hidden when creating an all-day event"
reason = "simplify the form when times are not relevant"
status = "draft"

# --- Recurrence Edit Protection Rules ---

[[rules]]
id = "rule-calendar-instance-no-recurrence"
feature_id = "feat-calendar-recurrence"
role = "Event Organizer"
requirement = "not see recurrence options when editing a single instance"
reason = "avoid confusion by only allowing recurrence changes when editing all occurrences"
status = "draft"

# --- Overlapping Event Display Rules ---

[[rules]]
id = "rule-calendar-overlap-side-by-side"
feature_id = "feat-calendar-overlap"
role = "Platform User"
requirement = "see overlapping events displayed side-by-side in day and week views"
reason = "quickly identify scheduling conflicts and compare overlapping commitments"
status = "active"

[[rules]]
id = "rule-calendar-overlap-duration-height"
feature_id = "feat-calendar-overlap"
role = "Platform User"
requirement = "see event height proportional to duration in day and week views"
reason = "visually understand how much time each event occupies"
status = "active"

[[rules]]
id = "rule-calendar-overlap-lanes"
feature_id = "feat-calendar-overlap"
role = "Platform User"
requirement = "see overlapping events split into equal-width columns (lanes)"
reason = "make the most efficient use of horizontal space for conflicting events"
status = "active"

# --- Current Time Indicator Rules ---

[[rules]]
id = "rule-calendar-time-indicator-visible"
feature_id = "feat-calendar-current-time"
role = "Platform User"
requirement = "see a colored bar indicating the current time when viewing today in Day view"
reason = "quickly understand where I am in the day relative to my scheduled events"
status = "active"

[[rules]]
id = "rule-calendar-time-indicator-realtime"
feature_id = "feat-calendar-current-time"
role = "Platform User"
requirement = "see the time indicator update automatically without refreshing the page"
reason = "always have an accurate view of the current time without manual action"
status = "active"

[[rules]]
id = "rule-calendar-time-indicator-today-only"
feature_id = "feat-calendar-current-time"
role = "Platform User"
requirement = "only see the time indicator when viewing today's date"
reason = "avoid confusion when viewing past or future days"
status = "active"

# --- Navigation Rules ---

[[rules]]
id = "rule-calendar-navigate"
feature_id = "feat-calendar-navigation"
role = "Platform User"
requirement = "navigate forward and backward through months or weeks"
reason = "view past and future schedules"
status = "draft"

[[rules]]
id = "rule-calendar-today"
feature_id = "feat-calendar-navigation"
role = "Platform User"
requirement = "jump directly to today's date"
reason = "quickly return to current schedule after browsing"
status = "draft"

# --- Participant Rules ---

[[rules]]
id = "rule-calendar-add-participants"
feature_id = "feat-calendar-participants"
role = "Event Organizer"
requirement = "add personnel as participants to an event"
reason = "invite colleagues to meetings"
status = "draft"

# --- Timezone Rules ---

[[rules]]
id = "rule-calendar-timezone-select"
feature_id = "feat-calendar-timezone"
role = "Platform User"
requirement = "select a timezone for a calendar event when creating or editing"
reason = "schedule events in the appropriate timezone regardless of current location"
status = "draft"

[[rules]]
id = "rule-calendar-timezone-local-preview"
feature_id = "feat-calendar-timezone"
role = "Platform User"
requirement = "see a local time preview when the event timezone differs from my local timezone"
reason = "understand when the event will occur in my local time without manual conversion"
status = "draft"

[[rules]]
id = "rule-calendar-timezone-details"
feature_id = "feat-calendar-timezone"
role = "Platform User"
requirement = "see both event timezone time and my local time in the event details panel when timezones differ"
reason = "quickly understand event timing in both the organizer's and my own timezone"
status = "draft"

# ============================================================================
# SCENARIOS - Calendar BDD Test Cases
# ============================================================================

# --- Month View Scenarios ---

[[scenarios]]
id = "scen-calendar-month-display"
rule_id = "rule-calendar-month-view"
name = "Display month grid"
narrative = "Given I am signed in, when I navigate to Calendar, then I see a month grid with day cells and colored event pills"
status = "draft"

[[scenarios]]
id = "scen-calendar-month-nav"
rule_id = "rule-calendar-navigate"
name = "Navigate between months"
narrative = "Given I am viewing the calendar in month view, when I click the next arrow, then the display advances to the next month"
status = "draft"

[[scenarios]]
id = "scen-calendar-week-nav"
rule_id = "rule-calendar-navigate"
name = "Navigate between weeks"
narrative = "Given I am viewing the calendar in week view, when I click the next arrow, then the display advances by one week"
status = "draft"

[[scenarios]]
id = "scen-calendar-today"
rule_id = "rule-calendar-today"
name = "Jump to today"
narrative = "Given I am viewing a future month, when I click Today, then the calendar returns to the current month with today highlighted"
status = "draft"

# --- Week View Scenarios ---

[[scenarios]]
id = "scen-calendar-week-display"
rule_id = "rule-calendar-week-view"
name = "Display week view with time slots"
narrative = "Given I am viewing the calendar in week mode, then I see 7 day columns with time slots from 6AM to 10PM"
status = "draft"

[[scenarios]]
id = "scen-calendar-workweek-toggle"
rule_id = "rule-calendar-workweek"
name = "Toggle work week mode in week view"
narrative = "Given I am viewing the calendar in week view, when I enable work week mode, then only Monday through Friday columns are displayed"
status = "draft"

[[scenarios]]
id = "scen-calendar-workweek-month"
rule_id = "rule-calendar-workweek"
name = "Toggle work week mode in month view"
narrative = "Given I am viewing the calendar in month view, when I enable work week mode, then the month grid shows only Monday through Friday columns"
status = "draft"

# --- Day View Scenarios ---

[[scenarios]]
id = "scen-calendar-day-display"
rule_id = "rule-calendar-day-view"
name = "Display day view with time slots"
narrative = "Given I click the Day view button, then I see a single day column with hourly time slots from 6AM to 10PM"
status = "draft"

[[scenarios]]
id = "scen-calendar-day-nav"
rule_id = "rule-calendar-day-nav"
name = "Navigate between days"
narrative = "Given I am viewing the calendar in day view, when I click the next arrow, then the display advances by one day"
status = "draft"

[[scenarios]]
id = "scen-calendar-day-toggle"
rule_id = "rule-calendar-day-view"
name = "Toggle to day view from month or week"
narrative = "Given I am in month or week view, when I click the Day button, then the view changes to show only the current day with time slots"
status = "draft"

# --- All Day Event Scenarios ---

[[scenarios]]
id = "scen-calendar-all-day-create"
rule_id = "rule-calendar-all-day-toggle"
name = "Create all-day event"
narrative = "Given I am creating an event, when I toggle 'All Day' on, then the time fields are hidden and the event is saved as an all-day event"
status = "draft"

[[scenarios]]
id = "scen-calendar-all-day-no-time"
rule_id = "rule-calendar-all-day-display"
name = "All-day events display without time"
narrative = "Given an all-day event exists, when I view it in the calendar or details panel, then no start/end time is displayed"
status = "draft"

[[scenarios]]
id = "scen-calendar-all-day-form-toggle"
rule_id = "rule-calendar-all-day-form"
name = "All-day toggle hides time fields"
narrative = "Given I am creating or editing an event, when I enable the All Day toggle, then the start time and end time fields are hidden"
status = "draft"

# --- Recurrence Edit Protection Scenarios ---

[[scenarios]]
id = "scen-calendar-edit-instance-no-recurrence"
rule_id = "rule-calendar-instance-no-recurrence"
name = "Hide recurrence fields when editing single instance"
narrative = "Given I am editing a single instance of a recurring event (This Occurrence Only), then the recurrence options are not visible in the edit form"
status = "draft"

[[scenarios]]
id = "scen-calendar-edit-series-shows-recurrence"
rule_id = "rule-calendar-series-edit"
name = "Show recurrence fields when editing all occurrences"
narrative = "Given I am editing all occurrences of a recurring event, then the recurrence options are visible and can be modified"
status = "draft"

# --- Overlapping Event Scenarios ---

[[scenarios]]
id = "scen-calendar-overlap-side-by-side"
rule_id = "rule-calendar-overlap-side-by-side"
name = "Display two overlapping events side-by-side"
narrative = "Given two events overlap in time (e.g., Interview 14:00-16:00 and Sprint Review 15:00-16:30 on Dec 19), when I view the day in day or week view, then both events display side-by-side in separate columns"
status = "active"

[[scenarios]]
id = "scen-calendar-overlap-three-events"
rule_id = "rule-calendar-overlap-lanes"
name = "Display three overlapping events in three columns"
narrative = "Given three events all overlap in time, when I view the day, then the events display in three equal-width columns"
status = "active"

[[scenarios]]
id = "scen-calendar-overlap-duration-visible"
rule_id = "rule-calendar-overlap-duration-height"
name = "Longer events appear taller than shorter events"
narrative = "Given a 2-hour event and a 30-minute event, when I view them in day or week view, then the 2-hour event has approximately 4x the height of the 30-minute event"
status = "active"

[[scenarios]]
id = "scen-calendar-overlap-recurring"
rule_id = "rule-calendar-overlap-side-by-side"
name = "Recurring events on same day display side-by-side"
narrative = "Given two bi-weekly recurring events that fall on the same day (e.g., Interview Block and Sprint Review both on Dec 19), when I view that day, then both instances display side-by-side"
status = "active"

# --- Current Time Indicator Scenarios ---

[[scenarios]]
id = "scen-calendar-time-indicator-display"
rule_id = "rule-calendar-time-indicator-visible"
name = "Time indicator visible on today's Day view"
narrative = "Given I am viewing today's date in Day view, then I see a colored horizontal bar indicating the current time positioned at the correct hour/minute"
status = "active"

[[scenarios]]
id = "scen-calendar-time-indicator-updates"
rule_id = "rule-calendar-time-indicator-realtime"
name = "Time indicator updates in real-time"
narrative = "Given I am viewing today's Day view, when time passes, then the indicator moves down automatically without page refresh"
status = "active"

[[scenarios]]
id = "scen-calendar-time-indicator-hidden-other-days"
rule_id = "rule-calendar-time-indicator-today-only"
name = "Time indicator hidden on other days"
narrative = "Given I am viewing a date other than today in Day view, then no time indicator is displayed"
status = "active"

# --- Timezone Scenarios ---

[[scenarios]]
id = "scen-calendar-timezone-select"
rule_id = "rule-calendar-timezone-select"
name = "Select event timezone"
narrative = "Given I am creating or editing an event, when I select a timezone from the timezone dropdown, then the event is saved with that timezone"
status = "draft"

[[scenarios]]
id = "scen-calendar-timezone-local-preview"
rule_id = "rule-calendar-timezone-local-preview"
name = "Display local time preview in edit mode"
narrative = "Given I am editing an event with a timezone different from my local timezone, when I view the event form, then I see a local time preview showing the event time converted to my local timezone"
status = "draft"

[[scenarios]]
id = "scen-calendar-timezone-same-tz-no-preview"
rule_id = "rule-calendar-timezone-local-preview"
name = "Hide local time preview when timezones match"
narrative = "Given I am editing an event with a timezone matching my local timezone, when I view the event form, then no local time preview is shown"
status = "draft"

[[scenarios]]
id = "scen-calendar-timezone-details-display"
rule_id = "rule-calendar-timezone-details"
name = "Display local time in details panel"
narrative = "Given I am viewing details of an event with a timezone different from my local timezone, when the details panel opens, then I see both the event time in its original timezone and my local time"
status = "draft"

[[scenarios]]
id = "scen-calendar-timezone-details-same-tz"
rule_id = "rule-calendar-timezone-details"
name = "Hide local time in details when timezones match"
narrative = "Given I am viewing details of an event with a timezone matching my local timezone, when the details panel opens, then only the event time is shown without a separate local time row"
status = "draft"

# --- Event Creation Scenarios ---

[[scenarios]]
id = "scen-calendar-create-simple"
rule_id = "rule-calendar-create"
name = "Create simple event"
narrative = "Given I click New Event, when I fill in title, date, and time and click Save, then the event appears on the calendar"
status = "draft"

[[scenarios]]
id = "scen-calendar-create-recurring"
rule_id = "rule-calendar-recurrence-create"
name = "Create recurring weekly event"
narrative = "Given I am creating an event, when I enable recurrence with Weekly frequency and select Mon/Wed/Fri, then events appear on those days"
status = "draft"

[[scenarios]]
id = "scen-calendar-recurrence-until"
rule_id = "rule-calendar-recurrence-until"
name = "Set recurrence end date"
narrative = "Given I am creating a recurring event, when I set an end date using the Until date picker, then events only appear up to that date"
status = "draft"

# --- Event Details Scenarios ---

[[scenarios]]
id = "scen-calendar-view-detail"
rule_id = "rule-calendar-view-detail"
name = "View event details panel"
narrative = "Given I am viewing the calendar, when I click on an event pill, then a details panel opens showing title, time, location, and participants"
status = "draft"

[[scenarios]]
id = "scen-calendar-edit-event"
rule_id = "rule-calendar-edit"
name = "Edit existing event"
narrative = "Given I have an event details panel open, when I click Edit, modify fields, and Save, then the changes are reflected in the calendar"
status = "draft"

[[scenarios]]
id = "scen-calendar-delete-event"
rule_id = "rule-calendar-delete"
name = "Delete single event"
narrative = "Given I have an event details panel open, when I click Delete and confirm, then the event is removed from the calendar"
status = "draft"

# --- Recurring Instance Scenarios ---

[[scenarios]]
id = "scen-calendar-cancel-instance"
rule_id = "rule-calendar-instance-cancel"
name = "Cancel single recurrence instance"
narrative = "Given I click on one instance of a recurring event, when I select Cancel This Instance, then only that date is removed while other occurrences remain"
status = "draft"

[[scenarios]]
id = "scen-calendar-modify-instance"
rule_id = "rule-calendar-instance-modify"
name = "Modify single recurrence instance"
narrative = "Given I am editing one instance of a recurring event, when I change the time and save for This Instance Only, then only that occurrence is updated"
status = "draft"

# --- Delete/Edit Choice Scenarios ---

[[scenarios]]
id = "scen-calendar-delete-instance"
rule_id = "rule-calendar-recurring-delete-choice"
name = "Delete only this occurrence"
narrative = "Given I click delete on a recurring event, when the dialog appears and I select 'Just This Occurrence', then only that date is removed while other instances remain"
status = "draft"

[[scenarios]]
id = "scen-calendar-delete-series"
rule_id = "rule-calendar-recurring-delete-choice"
name = "Delete all occurrences"
narrative = "Given I click delete on a recurring event, when the dialog appears and I select 'All Occurrences', then the entire series is removed from the calendar"
status = "draft"

[[scenarios]]
id = "scen-calendar-edit-instance-only"
rule_id = "rule-calendar-recurring-edit-choice"
name = "Edit only this occurrence"
narrative = "Given I click edit on a recurring event, when the dialog appears and I select 'This Occurrence Only', then I can modify just that instance while others remain unchanged"
status = "draft"

[[scenarios]]
id = "scen-calendar-edit-series"
rule_id = "rule-calendar-recurring-edit-choice"
name = "Edit entire series"
narrative = "Given I click edit on a recurring event, when the dialog appears and I select 'All Occurrences', then my changes apply to all instances of the series"
status = "draft"

[[scenarios]]
id = "scen-calendar-edit-series-recurrence-loaded"
rule_id = "rule-calendar-series-edit"
name = "Recurrence info loads when editing series"
narrative = "Given a weekly event recurring on Mon/Wed/Fri, when editing all occurrences, then the edit modal shows Mon/Wed/Fri selected"
status = "draft"

[[scenarios]]
id = "scen-calendar-move-instance"
rule_id = "rule-calendar-instance-move"
name = "Move recurring instance to different date"
narrative = "Given a Mon/Wed recurring event starting Jan 6, when I edit Wed Jan 15 and change the date to Thu Jan 16, then Wed Jan 15 shows no event and Thu Jan 16 shows the event"
status = "draft"

[[scenarios]]
id = "scen-calendar-moved-instance-survives-pattern-change"
rule_id = "rule-calendar-series-edit"
name = "Moved instance persists through recurrence pattern change"
narrative = "Given a Mon/Wed recurring event where I moved Wed Jan 15 to Thu Jan 16, when I change the series recurrence to Tue/Thu, then Thu Jan 16 still shows only one event (not duplicated)"
status = "draft"

[[scenarios]]
id = "scen-calendar-cancelled-instance-reactivates"
rule_id = "rule-calendar-instance-cancel"
name = "Cancelled instance remains cancelled after pattern change and restore"
narrative = "Given a Mon/Wed recurring event where I cancelled Wed Jan 15, when I change the series to Tue/Thu and then back to Mon/Wed, then Wed Jan 15 is still cancelled"
status = "draft"

# ============================================================================
# EMAIL MODULE - Internal Messaging (Gmail/Proton-like UX)
# ============================================================================
# MVP Scope: Internal messaging with personnel directory + custom addresses
# No external SMTP/IMAP integration required

[[objectives]]
id = "obj-email-core"
title = "Internal Email Communications"
description = "Users must be able to send and receive internal messages to colleagues in the personnel directory, as well as external contacts via custom email addresses, with a familiar email-like experience"
project_id = "d4e5f6"
parent_id = "obj-collaboration-future"
status = "in_progress"

[[objectives]]
id = "obj-email-organization"
title = "Email Organization"
description = "Users must be able to organize their messages with folders (Inbox, Sent, Drafts, Trash) and search to efficiently manage their communications"
project_id = "d4e5f6"
parent_id = "obj-collaboration-future"
status = "in_progress"

[[objectives]]
id = "obj-email-threading"
title = "Email Conversation Threading"
description = "Users must be able to view and participate in conversation threads to maintain context across multiple email exchanges"
project_id = "d4e5f6"
parent_id = "obj-collaboration-future"
status = "in_progress"

# --- Email Features ---

[[features]]
id = "feat-email-compose"
name = "Email Composition"
description = "Compose and send messages to personnel or custom email addresses with plain text body"
objective_id = "obj-email-core"
status = "in_progress"

[[features]]
id = "feat-email-recipients"
name = "Recipient Selection"
description = "Select recipients from personnel directory or enter custom email addresses"
objective_id = "obj-email-core"
status = "in_progress"

[[features]]
id = "feat-email-inbox"
name = "Email Inbox"
description = "View received messages with sender, subject, preview, and timestamp"
objective_id = "obj-email-core"
status = "in_progress"

[[features]]
id = "feat-email-reading"
name = "Email Reading"
description = "View full email content with sender info, timestamp, and message body"
objective_id = "obj-email-core"
status = "in_progress"

[[features]]
id = "feat-email-thread"
name = "Email Threading"
description = "View and reply to message threads/conversations with full context"
objective_id = "obj-email-threading"
status = "in_progress"

[[features]]
id = "feat-email-folders"
name = "Email Folders"
description = "Organize messages in Inbox, Sent, Drafts, and Trash folders"
objective_id = "obj-email-organization"
status = "in_progress"

[[features]]
id = "feat-email-search"
name = "Email Search"
description = "Search messages by sender, subject, and content"
objective_id = "obj-email-organization"
status = "in_progress"

# --- Email Rules: Composition ---

[[rules]]
id = "rule-email-compose"
feature_id = "feat-email-compose"
role = "Platform User"
requirement = "compose a new email with recipients, subject, and body"
reason = "communicate with colleagues and contacts"
status = "draft"

[[rules]]
id = "rule-email-recipient-personnel"
feature_id = "feat-email-recipients"
role = "Platform User"
requirement = "search and select recipients from the personnel directory using type-ahead search"
reason = "easily find and address colleagues without remembering email addresses"
status = "draft"

[[rules]]
id = "rule-email-recipient-custom"
feature_id = "feat-email-recipients"
role = "Platform User"
requirement = "enter a custom email address as a recipient"
reason = "contact external parties or addresses not in the directory"
status = "draft"

[[rules]]
id = "rule-email-recipient-multiple"
feature_id = "feat-email-recipients"
role = "Platform User"
requirement = "add multiple recipients (To, CC, BCC) to a single email"
reason = "send the same message to multiple people"
status = "draft"

[[rules]]
id = "rule-email-send"
feature_id = "feat-email-compose"
role = "Platform User"
requirement = "send the composed email to all selected recipients"
reason = "deliver my message"
status = "draft"

[[rules]]
id = "rule-email-drafts-save"
feature_id = "feat-email-folders"
role = "Platform User"
requirement = "save an email as a draft to finish later"
reason = "continue composing when I have more time"
status = "draft"

[[rules]]
id = "rule-email-drafts-edit"
feature_id = "feat-email-folders"
role = "Platform User"
requirement = "open and continue editing a saved draft"
reason = "complete and send a message I started earlier"
status = "draft"

# --- Email Rules: Inbox & Reading ---

[[rules]]
id = "rule-email-inbox-view"
feature_id = "feat-email-inbox"
role = "Platform User"
requirement = "view my inbox with unread indicators, sender names, subjects, preview text, and timestamps"
reason = "quickly scan new messages and prioritize what to read"
status = "draft"

[[rules]]
id = "rule-email-unread-count"
feature_id = "feat-email-inbox"
role = "Platform User"
requirement = "see the count of unread messages in my inbox"
reason = "know how many new messages await my attention"
status = "draft"

[[rules]]
id = "rule-email-read"
feature_id = "feat-email-reading"
role = "Platform User"
requirement = "open and read a full email message with sender, date, recipients, and body"
reason = "understand the complete communication"
status = "draft"

[[rules]]
id = "rule-email-mark-read"
feature_id = "feat-email-reading"
role = "Platform User"
requirement = "have emails marked as read when I open them"
reason = "track which messages I have already reviewed"
status = "draft"

# --- Email Rules: Threading & Reply ---

[[rules]]
id = "rule-email-reply"
feature_id = "feat-email-thread"
role = "Platform User"
requirement = "reply to an email maintaining the conversation thread"
reason = "continue the discussion in context"
status = "draft"

[[rules]]
id = "rule-email-reply-all"
feature_id = "feat-email-thread"
role = "Platform User"
requirement = "reply to all recipients of an email"
reason = "keep everyone in the conversation informed"
status = "draft"

[[rules]]
id = "rule-email-forward"
feature_id = "feat-email-thread"
role = "Platform User"
requirement = "forward an email to other recipients with original content preserved"
reason = "share relevant information with others who were not on the original message"
status = "draft"

[[rules]]
id = "rule-email-thread-view"
feature_id = "feat-email-thread"
role = "Platform User"
requirement = "view all messages in a conversation thread together in chronological order"
reason = "see the full context of a discussion"
status = "draft"

# --- Email Rules: Folders ---

[[rules]]
id = "rule-email-folder-nav"
feature_id = "feat-email-folders"
role = "Platform User"
requirement = "navigate between Inbox, Sent, Drafts, and Trash folders"
reason = "access different categories of messages"
status = "draft"

[[rules]]
id = "rule-email-sent-view"
feature_id = "feat-email-folders"
role = "Platform User"
requirement = "view emails I have sent in the Sent folder"
reason = "reference past communications I initiated"
status = "draft"

[[rules]]
id = "rule-email-delete"
feature_id = "feat-email-folders"
role = "Platform User"
requirement = "move messages to trash"
reason = "remove unwanted messages from my inbox"
status = "draft"

[[rules]]
id = "rule-email-trash-view"
feature_id = "feat-email-folders"
role = "Platform User"
requirement = "view and recover deleted messages from Trash"
reason = "retrieve accidentally deleted emails"
status = "draft"

# --- Email Rules: Search ---

[[rules]]
id = "rule-email-search"
feature_id = "feat-email-search"
role = "Platform User"
requirement = "search emails by keyword matching sender name, subject, or body content"
reason = "find specific messages quickly"
status = "draft"

# ============================================================================
# Email Scenarios - BDD Test Cases
# ============================================================================

# --- Inbox Scenarios ---

[[scenarios]]
id = "scen-email-inbox-empty"
rule_id = "rule-email-inbox-view"
name = "View empty inbox"
narrative = "Given I am a new user with no messages, when I navigate to Email, then I see an empty inbox with a prompt to compose my first message"
status = "draft"

[[scenarios]]
id = "scen-email-inbox-list"
rule_id = "rule-email-inbox-view"
name = "View inbox messages"
narrative = "Given I have received messages, when I navigate to Email, then I see my inbox with messages showing sender name, subject, preview, and timestamp with unread messages visually highlighted"
status = "draft"

[[scenarios]]
id = "scen-email-inbox-unread"
rule_id = "rule-email-unread-count"
name = "Unread count displayed"
narrative = "Given I have 3 unread messages, when I view the Email sidebar, then I see '3' displayed next to the Inbox folder"
status = "draft"

# --- Composition Scenarios ---

[[scenarios]]
id = "scen-email-compose-open"
rule_id = "rule-email-compose"
name = "Open compose modal"
narrative = "Given I am viewing Email, when I click Compose, then a compose modal appears with To, Subject, and Body fields"
status = "draft"

[[scenarios]]
id = "scen-email-compose-personnel"
rule_id = "rule-email-recipient-personnel"
name = "Select recipient from directory"
narrative = "Given I am composing an email, when I type a colleague's name in the To field, then I see matching personnel from the directory and can select one as a recipient"
status = "draft"

[[scenarios]]
id = "scen-email-compose-custom"
rule_id = "rule-email-recipient-custom"
name = "Enter custom email address"
narrative = "Given I am composing an email, when I type 'client@external.com' and press Enter, then the custom address is added as a recipient chip"
status = "draft"

[[scenarios]]
id = "scen-email-compose-multiple"
rule_id = "rule-email-recipient-multiple"
name = "Add multiple recipients"
narrative = "Given I am composing an email, when I add Alex Chen to To and Sarah Johnson to CC, then both appear as recipient chips in their respective fields"
status = "draft"

[[scenarios]]
id = "scen-email-compose-send"
rule_id = "rule-email-send"
name = "Send email"
narrative = "Given I have composed an email with recipient, subject, and body, when I click Send, then the compose modal closes, the message appears in my Sent folder, and the recipient sees it in their Inbox"
status = "draft"

# --- Draft Scenarios ---

[[scenarios]]
id = "scen-email-draft-save"
rule_id = "rule-email-drafts-save"
name = "Save draft"
narrative = "Given I am composing an email, when I click Save Draft or close the compose modal without sending, then the email is saved to my Drafts folder"
status = "draft"

[[scenarios]]
id = "scen-email-draft-edit"
rule_id = "rule-email-drafts-edit"
name = "Edit and send draft"
narrative = "Given I have a saved draft, when I open it from Drafts, complete the message, and click Send, then the draft is removed from Drafts and the email is sent"
status = "draft"

# --- Reading Scenarios ---

[[scenarios]]
id = "scen-email-read-open"
rule_id = "rule-email-read"
name = "Read email content"
narrative = "Given I have unread messages in my inbox, when I click on a message, then the reading pane displays the sender, date, recipients, subject, and full body"
status = "draft"

[[scenarios]]
id = "scen-email-read-marks-read"
rule_id = "rule-email-mark-read"
name = "Opening email marks as read"
narrative = "Given I have an unread message, when I click to open it, then it is marked as read and no longer appears highlighted as new"
status = "draft"

# --- Reply & Forward Scenarios ---

[[scenarios]]
id = "scen-email-reply"
rule_id = "rule-email-reply"
name = "Reply to email"
narrative = "Given I am reading an email from Alex Chen, when I click Reply and send my response, then Alex receives my reply and both messages appear in the same thread"
status = "draft"

[[scenarios]]
id = "scen-email-reply-all"
rule_id = "rule-email-reply-all"
name = "Reply all"
narrative = "Given I received an email sent to me and CC'd to Sarah, when I click Reply All and respond, then both the original sender and Sarah receive my reply"
status = "draft"

[[scenarios]]
id = "scen-email-forward"
rule_id = "rule-email-forward"
name = "Forward email"
narrative = "Given I am reading an email, when I click Forward, add Mike Smith as recipient, and send, then Mike receives the forwarded message with the original content quoted"
status = "draft"

[[scenarios]]
id = "scen-email-thread-view"
rule_id = "rule-email-thread-view"
name = "View conversation thread"
narrative = "Given an email thread with 3 messages, when I open any message in the thread, then I see all 3 messages displayed in chronological order"
status = "draft"

# --- Folder Scenarios ---

[[scenarios]]
id = "scen-email-folder-nav"
rule_id = "rule-email-folder-nav"
name = "Navigate folders"
narrative = "Given I am viewing my Inbox, when I click on Sent, then the email list updates to show only messages I have sent"
status = "draft"

[[scenarios]]
id = "scen-email-sent-view"
rule_id = "rule-email-sent-view"
name = "View sent emails"
narrative = "Given I have sent emails, when I navigate to the Sent folder, then I see my sent messages with recipient, subject, and sent timestamp"
status = "draft"

[[scenarios]]
id = "scen-email-delete"
rule_id = "rule-email-delete"
name = "Delete email"
narrative = "Given I am viewing an email, when I click Delete, then the email is moved to Trash and removed from Inbox"
status = "draft"

[[scenarios]]
id = "scen-email-trash-recover"
rule_id = "rule-email-trash-view"
name = "Recover from trash"
narrative = "Given I have deleted an email, when I go to Trash and click Restore on the message, then it returns to my Inbox"
status = "draft"

# --- Search Scenarios ---

[[scenarios]]
id = "scen-email-search-basic"
rule_id = "rule-email-search"
name = "Search emails"
narrative = "Given I have multiple emails, when I enter 'quarterly report' in the search box, then I see only emails with matching subject or body content"
status = "draft"

[[scenarios]]
id = "scen-email-search-sender"
rule_id = "rule-email-search"
name = "Search by sender"
narrative = "Given I have emails from various senders, when I search for 'Alex Chen', then I see only emails from or mentioning Alex Chen"
status = "draft"

# ============================================================================
# CHAT MODULE - Team Messaging (Slack/Discord-like UX)
# ============================================================================

[[objectives]]
id = "obj-chat-core"
title = "Real-time Team Messaging"
description = "Users must be able to have real-time conversations with colleagues through direct messages and group channels"
project_id = "d4e5f6"
parent_id = "obj-collaboration-future"
status = "planned"

[[objectives]]
id = "obj-chat-engagement"
title = "Chat Engagement Features"
description = "Users must be able to engage with messages through reactions, replies, and rich formatting to enable expressive communication"
project_id = "d4e5f6"
parent_id = "obj-collaboration-future"
status = "planned"

# --- Chat Features ---

[[features]]
id = "feat-chat-dm"
name = "Direct Messages"
description = "One-on-one messaging between users"
objective_id = "obj-chat-core"
status = "planned"

[[features]]
id = "feat-chat-channels"
name = "Chat Channels"
description = "Group conversations organized by topic or team"
objective_id = "obj-chat-core"
status = "planned"

[[features]]
id = "feat-chat-messages"
name = "Message Composition"
description = "Send messages with text, emoji, and formatting"
objective_id = "obj-chat-core"
status = "planned"

[[features]]
id = "feat-chat-reactions"
name = "Message Reactions"
description = "React to messages with emoji"
objective_id = "obj-chat-engagement"
status = "planned"

[[features]]
id = "feat-chat-threads"
name = "Threaded Replies"
description = "Reply to specific messages in a thread"
objective_id = "obj-chat-engagement"
status = "planned"

[[features]]
id = "feat-chat-presence"
name = "User Presence"
description = "See online/offline status of colleagues"
objective_id = "obj-chat-core"
status = "planned"

# --- Chat Rules ---

[[rules]]
id = "rule-chat-dm-start"
feature_id = "feat-chat-dm"
role = "Platform User"
requirement = "start a direct message conversation with a colleague"
reason = "have a private one-on-one discussion"
status = "draft"

[[rules]]
id = "rule-chat-channel-create"
feature_id = "feat-chat-channels"
role = "Platform User"
requirement = "create a new channel with a name and optional description"
reason = "organize team conversations by topic"
status = "draft"

[[rules]]
id = "rule-chat-channel-join"
feature_id = "feat-chat-channels"
role = "Platform User"
requirement = "browse and join available channels"
reason = "participate in relevant team discussions"
status = "draft"

[[rules]]
id = "rule-chat-send"
feature_id = "feat-chat-messages"
role = "Platform User"
requirement = "send a message to a DM or channel"
reason = "communicate with colleagues in real-time"
status = "draft"

[[rules]]
id = "rule-chat-emoji"
feature_id = "feat-chat-messages"
role = "Platform User"
requirement = "insert emoji into messages"
reason = "express emotions and add personality"
status = "draft"

[[rules]]
id = "rule-chat-react"
feature_id = "feat-chat-reactions"
role = "Platform User"
requirement = "add an emoji reaction to any message"
reason = "acknowledge or respond without typing a full message"
status = "draft"

[[rules]]
id = "rule-chat-thread-reply"
feature_id = "feat-chat-threads"
role = "Platform User"
requirement = "reply to a specific message starting a thread"
reason = "have focused discussions without cluttering the main channel"
status = "draft"

[[rules]]
id = "rule-chat-presence"
feature_id = "feat-chat-presence"
role = "Platform User"
requirement = "see which colleagues are currently online"
reason = "know if someone is available for a conversation"
status = "draft"

# --- Chat Scenarios ---

[[scenarios]]
id = "scen-chat-dm-conversation"
rule_id = "rule-chat-dm-start"
name = "Start direct message"
narrative = "Given I click New Message, when I select a colleague and send a message, then a DM conversation is created and the message appears"
status = "draft"

[[scenarios]]
id = "scen-chat-channel-create"
rule_id = "rule-chat-channel-create"
name = "Create new channel"
narrative = "Given I click Create Channel, when I enter a name and description, then the channel appears in my channel list"
status = "draft"

[[scenarios]]
id = "scen-chat-react"
rule_id = "rule-chat-react"
name = "React to message"
narrative = "Given I hover over a message, when I click Add Reaction and select an emoji, then the reaction appears under the message"
status = "draft"

[[scenarios]]
id = "scen-chat-thread"
rule_id = "rule-chat-thread-reply"
name = "Reply in thread"
narrative = "Given I click Reply on a message, when I type and send my response, then it appears in a threaded view under the original message"
status = "draft"

# ============================================================================
# SCREEN SHARE MODULE - Remote Collaboration
# ============================================================================

[[objectives]]
id = "obj-screenshare-core"
title = "Screen Sharing Capability"
description = "Users must be able to share their screen with colleagues for remote collaboration and presentations"
project_id = "d4e5f6"
parent_id = "obj-collaboration-future"
status = "planned"

# --- Screen Share Features ---

[[features]]
id = "feat-screenshare-start"
name = "Screen Share Session"
description = "Start and stop screen sharing with selected participants"
objective_id = "obj-screenshare-core"
status = "planned"

[[features]]
id = "feat-screenshare-view"
name = "Screen Share Viewer"
description = "View shared screens from other users"
objective_id = "obj-screenshare-core"
status = "planned"

[[features]]
id = "feat-screenshare-chat"
name = "Screen Share from Chat"
description = "Initiate screen sharing directly from a chat conversation"
objective_id = "obj-screenshare-core"
status = "planned"

# --- Screen Share Rules ---

[[rules]]
id = "rule-screenshare-start"
feature_id = "feat-screenshare-start"
role = "Platform User"
requirement = "start sharing my screen with one or more colleagues"
reason = "demonstrate something or collaborate visually"
status = "draft"

[[rules]]
id = "rule-screenshare-select"
feature_id = "feat-screenshare-start"
role = "Platform User"
requirement = "choose to share my entire screen or a specific window"
reason = "control what others can see"
status = "draft"

[[rules]]
id = "rule-screenshare-stop"
feature_id = "feat-screenshare-start"
role = "Platform User"
requirement = "stop sharing my screen at any time"
reason = "end the session when done"
status = "draft"

[[rules]]
id = "rule-screenshare-view"
feature_id = "feat-screenshare-view"
role = "Platform User"
requirement = "view when a colleague is sharing their screen"
reason = "follow along with their demonstration"
status = "draft"

[[rules]]
id = "rule-screenshare-from-chat"
feature_id = "feat-screenshare-chat"
role = "Platform User"
requirement = "click a Share Screen button in an active chat"
reason = "quickly share my screen during a conversation"
status = "draft"

# --- Screen Share Scenarios ---

[[scenarios]]
id = "scen-screenshare-start"
rule_id = "rule-screenshare-start"
name = "Start screen share"
narrative = "Given I click Share Screen, when I select a screen or window and click Start, then participants see my shared screen"
status = "draft"

[[scenarios]]
id = "scen-screenshare-from-dm"
rule_id = "rule-screenshare-from-chat"
name = "Share screen from DM"
narrative = "Given I am in a DM conversation, when I click the Share Screen button, then my screen becomes visible to the other person"
status = "draft"

[[scenarios]]
id = "scen-screenshare-stop"
rule_id = "rule-screenshare-stop"
name = "Stop screen share"
narrative = "Given I am sharing my screen, when I click Stop Sharing, then participants no longer see my screen"
status = "draft"

